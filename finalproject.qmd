---
title: "final_project"
format: html
editor_options: 
  chunk_output_type: console
---
```{r}
library(tidyverse)
library(ggplot2)
library(here)
library(kableExtra)
```

```{r}
food <- read_csv(here("data","food_affordability_2006_2010.csv"))
counties <- read.csv(here("data","california_counties.csv"))
```

```{r}
# decided to drop NAs because many missing obs for independent variables. data is from various survey data compiled to make 1
food <- food %>%
  filter(!is.na(affordability_ratio)) %>%
  # filter(!(race_eth_name %in% c("Total", "Other", "AIAN", "NHOPI", "Multiple", "Asian"))) %>%
  select(-region_name)
```


```{r}
# classify counties by region to make 5 level categorical variable

superior <- c("Butte","Colusa","Del Norte","Glenn","Humboldt","Lake","Lassen","Mendocino","Modoc","Nevada","Plumas","Shasta", "Sierra","Siskiyou","Tehama","Trinity")

central <- c("Alpine","Amador","El Dorado","Fresno","Inyo","Kings","Madera","Mariposa","Merced","Mono","Placer","Sacramento","San Joaquin","Stanislaus","Sutter","Yuba","Tulare","Tuolumne","Yolo", "Calaveras")

bay_area <- c("Almeda","Contra Costa","Marin","Monterey","Napa","San Benito","San Fracisco","San Mateo","Santa Clara","Santa Cruz","Solano","Sonoma")

southern <- c("Imperial","Kern","Orange","Riverside","San Bernardino","San Diego","San Luis Obispo","Santa Barbara","Ventura")

los_angeles <- "Los Angeles"
```

```{r}
region_mapping <- data.frame(
  county_name = c(superior, central, bay_area, southern, los_angeles),
  region_name = rep(c('superior', 'central', 'bay_area', 'southern','los_angeles'), 
               times = c(length(superior), length(central), length(bay_area), length(southern),length(los_angeles))))

food <- inner_join(food, region_mapping, by = "county_name")
```

```{r}
food_cost_lm <- lm(cost_yr ~ median_income + region_name + ave_fam_size + region_name * median_income, data = food)
# r squared lower when accounting for race 
# should try removing the outliers in median_income and affordability food ratio
# in "ave_fam_size" all races are combined, race variable not ideal in model

summary(food_cost_lm)
```

```{r}
food_cost_lm <- lm(cost_yr ~ median_income + region_name + region_name * median_income, data = food)
# r squared lower when accounting for race 
# should try removing the outliers in median_income and affordability food ratio
# in "ave_fam_size" all races are combined, race variable not ideal in model

summary(food_cost_lm)
```

```{r}
# Create a histogram for median_income
ggplot(food, aes(x = median_income)) +
  geom_histogram(binwidth = 5000, fill = "firebrick2", color = "white") +
  labs(title = "Histogram of median income", 
       x = "Median income", 
       y = "Frequency") +
  theme_bw() +
  theme(text = element_text(family = "courier"),
        panel.background = element_rect(colour = "white"))
```

```{r}
library(car)
vif_results <- vif(food_cost_lm) 
vif_results %>%
  as.data.frame()

vif_table <- vif_results %>%
  kable("html", col.names = c("Variable", "GVIF", "Degrees of freedom", "Adjusted GVIF")) %>%
  kable_styling(full_width = FALSE, bootstrap_options = c("striped", "hover", "condensed")) %>%
  print()



```

# response variable = affordability ratio
# independent variables / predictors
# county - but must drop NAs (136) <- categorical
# median_income <- numerical 
# average family size <- numerical 

#### Hypothesis:
median income, family size 
female-headed households



